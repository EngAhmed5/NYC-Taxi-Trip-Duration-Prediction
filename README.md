# NYC Taxi Trip Duration Prediction

This project aims to predict the **trip duration** of NYC yellow taxi rides based on trip and location features using machine learning techniques. The final model uses Ridge Regression combined with polynomial feature engineering, and MLflow is integrated to track experiment runs.

---

Project Structure Description
The NYC Taxi Trip Duration Prediction project is organized to facilitate clear workflow management, reproducibility, and ease of understanding. Below is an overview of the main directories and files included in the repository:

Data/
This folder contains the cleaned datasets used throughout the project, including train.csv, val.csv, and test.csv. These files represent the training, validation, and testing data respectively.

EDA/
This directory holds the Exploratory Data Analysis materials. It includes notebooks such as eda_notebook.ipynb, which provide detailed insights and visualizations revealing patterns and trends in the dataset that guide feature engineering and modeling decisions.

mlruns/
This folder stores the MLflow tracking artifacts. It includes experiment metadata, logged parameters, metrics, and model artifacts generated during the machine learning lifecycle to ensure experiment tracking and reproducibility.

modeling and mlflow/
This directory contains all scripts related to model development and experiment management:

preprocessing.py: Defines the data preprocessing pipeline, including steps like feature encoding and scaling.

train.py: Contains the logic for training the machine learning model on the prepared datasets.

test.py: Implements the evaluation procedures to test the trained model‚Äôs performance on unseen data.

trip_duration_mlflow.py: Manages MLflow experiment tracking and logging of parameters, metrics, and models.

model.py: Defines the model architecture or wraps the machine learning model for training and inference.

model.pkl: The final serialized trained model saved using pickle for deployment or further testing.

NYC Taxi Trip Duration Prediction Report/
This folder contains the project‚Äôs final technical report in PDF format (report.pdf), summarizing the methodology, results, and conclusions.

Score‚Äôs Picture/
This directory includes images visualizing the model‚Äôs performance metrics, such as training and validation scores (train_val_scores.png) and test scores (test_scores.png), to provide a quick graphical summary of results.

predictions_sample.csv
A sample CSV file with output predictions generated by the model, demonstrating the expected format for submission or further analysis.

README.md
The main documentation file providing an overview of the project, instructions, and relevant details to help users understand and reproduce the work.
---

## üß∞ Tools & Libraries Used

- Python 3.x
- Pandas, NumPy
- Scikit-learn (Ridge Regression, Polynomial Features, Pipeline, etc.)
- Matplotlib & Seaborn (Visualization)
- MLflow (Experiment tracking and model registry)
- Jupyter Notebook (EDA)
- VS Code (Development environment)

---

## üìä Exploratory Data Analysis (EDA)

- Analyzed trip duration patterns by **weekday**, **month**, and **hour**.
- Visualized heatmaps showing trip frequency by time and day.
- Investigated correlations between features like distance, speed, pickup/dropoff locations.
- Identified outliers but **did not remove** them intentionally to avoid overfitting when using polynomial features.
- Key insight: Longer trips occur on weekends and warmer months; peak activity during evening rush hours.

---

## üîß Data Preprocessing & Feature Engineering

- Log transformation applied to trip duration and distance to normalize skewed distributions.
- Polynomial features up to degree 5 used on numerical data to capture non-linear relationships.
- One-hot encoding applied to categorical features.
- Standard scaling applied to numerical features before modeling.

---

## ‚öôÔ∏è Modeling

- **Model selected:** Ridge Regression with regularization parameter alpha=1.0.
- **Pipeline includes:** preprocessing (scaling, polynomial feature expansion, encoding) followed by Ridge Regression.
- **MLflow** used for tracking and managing experiment runs.

---

## üìà Model Performance

| Dataset    | RMSE   | R¬≤ Score   |
|------------|--------|------------|
| Training   | 0.433  | 70.34%     |
| Validation | 0.443  | 69.32%     |
| Test       | 0.433  | 70.45%     |

- RMSE: Root Mean Squared Error (lower is better)
- R¬≤ Score: Percentage of variance explained by the model (higher is better)
- The model generalizes well on validation and test sets, indicating balanced bias-variance.

---

## üîç Important Notes

- **Outliers Handling:** Outliers were **not removed** because polynomial features with degree 5 can cause overfitting on clean data. Keeping some noise and outliers helped maintain a balanced model without overfitting.
- **Feature Selection:** Distance (in km) is the strongest predictor of trip duration. Speed and location features also contribute but with less impact.
- **MLflow Integration:** All training runs, parameters, and metrics are logged with MLflow for easy experiment comparison.

---
